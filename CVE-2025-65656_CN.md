
# dcat-admin 扩展安装机制远程代码执行漏洞（CVE-2025-65656）

## 概述
在 dcat-admin <= 2.2.3-beta 版本中，其扩展安装机制存在一个远程代码执行（RCE）漏洞。
攻击者可通过上传恶意扩展包，使系统在解析扩展 version.php 文件时直接包含并执行任意 PHP 代码，从而获得对服务器的代码执行权限。

本漏洞已由 MITRE 正式分配编号：
CVE-2025-65656

## 漏洞影响范围
- 产品：dcat-admin
- 版本：<= 2.2.3-beta
- 组件：src/Extend/VersionManager.php
- 漏洞类型：PHP 文件包含 / RCE

## 技术细节
攻击者可构造恶意 ZIP 扩展，并通过 /admin/dcat-api/form/upload 上传并触发解析。
VersionManager 读取扩展包 version.php 时直接 include，无安全校验。
利用成功后可执行任意 PHP 代码并获取服务器控制权。

## 攻击条件
- 需拥有扩展上传权限（后台）
- 扩展解压目录可写

## PoC
https://github.com/lznlol/operation-log/blob/main/operation-log.zip
https://github.com/lznlol/operation-log/blob/main/POC.py
https://github.com/lznlol/operation-log/blob/main/POC.md

## 修复方案
等待官方修复。
或关闭扩展上传、增加 include 校验、限制执行目录权限。

## 致谢
研究员 ?c (lznlol) 发现此漏洞。
MITRE 已分配编号：CVE-2025-65656
